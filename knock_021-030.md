# 顧客の全体像を把握する１０本ノック

## データの読み込み

'csv/use_log.csv' を読み込め。

```python
import pandas as pd 

uselog = pd.read_csv('csv/use_log.csv') 
```

'csv/customer_master.csv' を読み込め。

```python
customer = pd.read_csv('csv/customer_master_w_class.csv')
```

'csv/class_master.csv' を読み込め。
```python
class_master = pd.read_csv('csv/class_master.csv') 
```

'csv/campaign_master.csv' を読み込め。
```python
campaign_master = pd.read_csv('csv/campaign_master.csv')
```

## データ整形

customer と class_master を 'class' をキーにマージせよ。

```python
customer_join = pd.merge(customer, class_master, on='class', how='left')
```

customer_join と campaign_master を 'campaign_id' をキーにマージせよ。

```python
customer_join = pd.merge(customer_join, campaign_master, on='campaign_id', how='left') 
```

customer_join の 欠損値のある 列を確認せよ。

```python
customer_join.isnull().any() 
```

```
customer_id      False
name             False
class            False
gender           False
start_date       False
end_date          True
campaign_id      False
is_deleted       False
class_name       False
price            False
campaign_name    False
dtype: bool
```

'end_date' が欠損している数を数えろ。

```python
customer_join['end_date'].isnull().sum()
```
```
2842
```

## 基礎集計

customer_join を 'class_name' 毎に集計して、カスタマー数を計算せよ。

```python
customer_join.groupby(by='class_name')['customer_id'].count()
```
```
class_name
オールタイム    2045
デイタイム     1019
ナイト       1128
Name: customer_id, dtype: int64
```

'campaign_name' 毎に集計して、カスタマー数を計算せよ。
```python
customer_join.groupby(by='campaign_name')['customer_id'].count()
```

```
campaign_name
入会費半額     650
入会費無料     492
通常       3050
Name: customer_id, dtype: int64
```

'gender' 毎に集計して、カスタマー数を計算せよ。

```python
customer_join.groupby(by='gender')['customer_id'].count()
```
```
gender
F    1983
M    2209
Name: customer_id, dtype: int64
```

'id_deleted' 毎に集計して、カスタマー数を計算せよ。

```python
customer_join.groupby(by='is_deleted')['customer_id'].count() 
```

```
is_deleted
0    2842
1    1350
Name: customer_id, dtype: int64
```

2018年4月1日以降に入会した顧客の data frame を抽出せよ。

```python
customer_join['start_date'] = pd.to_datetime(customer_join['start_date'])

customer_start = customer_join[customer_join['start_date'] >= pd.to_datetime('2018/04/01')]
```






