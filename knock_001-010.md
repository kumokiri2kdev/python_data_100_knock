# Web からの注文数を分析する１０本ノック

## データの読みこみ


'csv/customer_master.csv' を 'customer_master' として読み込め。

```python
import pandas as pd

customer_master = pd.read_csv('csv/customer_master.csv')
```

'csv/item_master.csv' を item_master として読み込め。

```python
item_master = pd.read_csv('csv/item_master.csv')
```

'csv/transaction_1.csv' を transaction_1 として読み込め。
```python
transaction_1 = pd.read_csv('csv/transaction_1.csv')  
```

'csv/transaction_detail_1.csv' を transaction_detail_1 として読み込め。
```python
transaction_detail_1 = pd.read_csv('csv/transaction_detail_1.csv')
```


## データの連結
csv/transaction_2.csv を読み込み、transaction_1 に連結せよ。

```python

transaction_2 = pd.read_csv('../csv/transaction_2.csv')

pd.concat([transaction_1, transaction_2], ignore_index=True)  
```

csv/transaction_detail_2.csv を読み込み、transaction_detail_1 と連結せよ。


```python
transaction_detail_2 = pd.read_csv('csv/transaction_detail_2.csv')

transaction_detail = pd.concat([transaction_detail_1, transaction_detail_2], ignore_index=True)
```

## データのマージ
transaction_detail に transaction の 'payment_date' と 'customer_id' を transaction_id をキーにしてマージせよ。

```python
join_data = pd.merge(   transaction_detail,  
                        transaction[['transaction_id', 'payment_date', 'customer_id']], 
                        on='transaction_id', how='left')  
```

join_data に 'item_id' をキーにして item_master をマージせよ。

```python
join_data = pd.merge(join_data, item_master, on='item_id', how='left')
```

## 列の追加

join_dataに 'quantity' と 'item_price' を掛けて 'price' 列を作成せよ。

```python
join_data['price'] = join_data['quantity'] * join_data['item_price']
```

## 計算
join_data の 'price' の合計を算出せよ。

```python
join_data['price'].sum()
```

join_data の 'price' の各種統計を算出せよ。
```python
join_data['price'].describe()
```

## 欠損値
join_data の欠損値の有無を確認せよ。
```python
join_data.isnull().sum()
```
## グループ化
join_data の 月ごとの 'price' の合計値を算出せよ。

```python
join_data['payment_month'] = pd.to_datetime(join_data['payment_date']).dt.strftime('%Y%m')  

join_data.groupby(by='payment_month')['price'].sum()
```

join_data の 月とアイテムごとの 'price' と 'quantity' の合計値を算出せよ。

```python
join_data.groupby(by=['payment_month','item_name'])[['price','quantity']].sum() 
```

## グラフ表示
join_data の price の 月ごとの合計値を折れ線グラフで表示せよ。

```python
graph_data = pd.pivot_table(join_data, index='item_name', columns='payment_month', values='price', aggfunc='sum')

import matplotlib.pyplot as plt

for idx in graph_data.index: 
    plt.plot(graph_data.columns.values, graph_data.loc[idx].values, label=idx) 
    
plt.legend()
plt.pause(0.5)
```